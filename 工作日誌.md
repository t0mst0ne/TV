# 工作日誌

## 2025-12-06

### 流動性與資產相關性分析 (Liquidity Correlation Analysis)

**目標**: 分析 TradingView `liquidity.html` 中的流動性指標與 SPY (S&P 500) 在過去 10 年的相關性。

**完成項目**:

1.  **符號提取**:
    - 從 `liquidity.html` 解析出所有 TradingView 符號 (FRED, Yahoo Finance, CryptoCap)。
    - 建立 `symbol.md` 作為參照表。

2.  **數據獲取與處理腳本 (`liquidity_correlation.py`)**:
    - 使用 `yfinance` 獲取價格數據 (SPY, BTC, JPY)。
    - 使用 `pandas_datareader` 獲取 FRED 經濟數據 (利率, TGA, RRP, 資產負債表)。
    - **指標計算**:
        - `Net Liquidity` = Fed Balance Sheet - TGA - RRP (轉換單位為 Billions)。
        - `Liquidity Stress` = SOFR - IORB。
    - **修復問題**: 解決 `yfinance` 0.2.x 版本 `auto_adjust` 參數導致的 `KeyError: 'Adj Close'` 問題。

3.  **相關性分析**:
    - 計算 **每週變化 (Weekly Changes)** 的 Pearson 相關係數。
    - 生成熱力圖 `liquidity_correlation_heatmap.png`。
    - **主要發現**:
        - **高收益債利差 (HY Spread)** 與 SPY 呈現最強負相關 (-0.71)，是有效的避險指標。
        - **Net Liquidity** 的每週變化與 SPY 相關性極低 (~0.03)，顯示其影響力主要在長期趨勢而非短期波動。

4.  **綜合圖表生成 (Comprehensive Analysis)**:
    - 為每個指標生成詳細圖表 (存於 `analysis_results/`):
        - **Price Overlay**: 雙軸價格走勢對照。
        - **Rolling Correlation**: 6個月與1年滾動相關性，觀察市場體制轉換 (Regime Shift)。
        - **Scatter Plot**: 每週回報散點圖。

## 2026-01-13

### 制度風險監控儀表板優化 (Institutional Risk Dashboard)

**目標**: 優化 `FED-USD.html` 的使用者體驗，實現圖表自動疊加與部署。

**完成項目**:

1.  **自動化圖表疊加**:
    - 修改 `createChart` 函數，新增 `overlays` 參數。
    - 使用 `Compare@tv-basicstudies` 實現透過代碼自動加載疊加商品，無需使用者手動輸入。
    - **配置更新**:
        - **US10Y**: 自動疊加 US02Y, US30Y。
        - **Spread**: 主圖 US30Y-US10Y，疊加 US10Y-US02Y。
        - **DXY**: 自動疊加 US10Y。
        - **USDCHF**: 自動疊加 USDJPY。
        - **Gold**: 自動疊加 實質利率。

2.  **數據源修正 (Real Yield Ticker)**:
    - 修正黃金圖表中「實質利率」的代碼問題。
    - 原公式 `US10Y-US10YTIP` (Nominal - Real = Breakeven) 與標籤「實質利率」不符且導致錯誤。
    - **解決方案**: 改用 **`FRED:DFII10`** (10-Year Treasury Inflation-Indexed Security, Constant Maturity)，即官方的 10年期實質利率數據。

3.  **檔案重命名與部署**:
    - 將 `FED-USD.html` 重命名為 **`USD.html`**。
    - 推送至 GitHub Pages: [https://t0mst0ne.github.io/TV/USD.html](https://t0mst0ne.github.io/TV/USD.html)
